{% extends "base.html" %}
{% block title %}
    Home
{% endblock title %}

{% block content %}
<h3>Please enter the following information to predict your flow.</h3>
<form method="POST">
    {% csrf_token %}
    <div class="form-group">
        {{ form.cramp_level.label }}
        {{ form.cramp_level }}
    </div>
    <div class="form-group">
        {{ form.height.label }}
        {{ form.height }}
    </div>
    <div class="form-group">
        {{ form.weight.label }}
        {{ form.weight }}
    </div>
    <div class="form-group">
        {{ form.age.label }}
        {{ form.age }}
    </div>
    <button type="submit" class="btn btn-primary">Submit</button>
</form>

<!-- Calendar  -->
<div id="dncalendar-container"></div>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Date Information</h4>
      </div>
      <div class="modal-body">
        <!-- Modal content will be dynamically loaded here -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Calendar and Modal Script -->
<script type="text/javascript">
  $(document).ready(function() {
    var my_calendar = $("#dncalendar-container").dnCalendar({
      dataTitles: { defaultDate: 'default', today: 'Today' },
      notes: [
        { "date": "2024-10-20", "note": ["Example note for October 20"] },
        { "date": "2024-10-25", "note": ["Example note for October 25"] }
      ],
      showNotes: true,
      dayClick: function(date, view) {
        var selectedDate = date.getDate() + "-" + (date.getMonth() + 1) + "-" + date.getFullYear();
        var note = "No notes for this date."; // Default message

        // Check if the selected date has a note
        for (var i = 0; i < my_calendar.notes.length; i++) {
          if (my_calendar.notes[i].date === date.toISOString().slice(0, 10)) {
            note = my_calendar.notes[i].note;
            break;
          }
        }

        // Show the modal and display the selected date and note
        $('#myModal').modal('show').on('shown.bs.modal', function() {
          $('.modal-body').html("<strong>Date:</strong> " + selectedDate + "<br><strong>Note:</strong> " + note);
        });
      }
    });

    // Initialize the calendar
    my_calendar.build();

    // Update calendar settings
    my_calendar.update({
      minDate: "2024-01-01",  // Minimum date range
      defaultDate: new Date()  // Default to today's date
    });
  });
</script>
{% endblock content %}
